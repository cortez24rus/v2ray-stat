# v2ray-stat API

API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π —Å–µ—Ä–≤–µ—Ä–∞ **v2ray-stat**.  
–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –Ω–∞ `http://127.0.0.1:9952`.

---

## üìã –°–ø–∏—Å–æ–∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

### –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**GET** `/api/v1/users`

```bash
curl -X GET http://127.0.0.1:9952/api/v1/users
```

### –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å–µ—Ä–≤–µ—Ä—É –∏ –∫–ª–∏–µ–Ω—Ç–∞–º

**GET** `/api/v1/stats`

–≠—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ —Å–µ—Ä–≤–µ—Ä—É –∏ –∫–ª–∏–µ–Ω—Ç–∞–º, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `stats_columns`.

```bash
curl -X GET http://127.0.0.1:9952/api/v1/stats
```

#### –û—Ç–≤–µ—Ç –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–í —Ñ–∞–π–ª–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ YAML –º–æ–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å, –∫–∞–∫–∏–µ –∫–æ–ª–æ–Ω–∫–∏ –≤—ã–≤–æ–¥–∏—Ç—å –∏ –ø–æ –∫–∞–∫–æ–º—É —Å—Ç–æ–ª–±—Ü—É —Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å:

```yaml
stats_columns:
  server:
    sort: rate DESC
    columns:
      - source
      - rate
      - uplink
      - downlink
  client:
    sort: user ASC
    columns:
      - user
      - last_seen
      - rate
      - uplink
      - downlink
```

#### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∫–æ–ª–æ–Ω–∫–∏:

* **–î–ª—è server:**

  * `source` ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ —Ç—Ä–∞—Ñ–∏–∫–∞ (IP –∏–ª–∏ hostname)
  * `rate` ‚Äî —Ç–µ–∫—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ (–±–∏—Ç/—Å)
  * `uplink` ‚Äî –≤—Å–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (–±–∞–π—Ç)
  * `downlink` ‚Äî –≤—Å–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–æ (–±–∞–π—Ç)
  * `sess_uplink` ‚Äî –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ (–±–∞–π—Ç)
  * `sess_downlink` ‚Äî –ø–æ–ª—É—á–µ–Ω–æ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ (–±–∞–π—Ç)

* **–î–ª—è client:**

  * `user` ‚Äî –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  * `uuid` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
  * `last_seen` ‚Äî –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  * `rate` ‚Äî —Ç–µ–∫—É—â–∏–π —Ç—Ä–∞—Ñ–∏–∫ (–±–∏—Ç/—Å)
  * `uplink` ‚Äî –≤—Å–µ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ (–±–∞–π—Ç)
  * `downlink` ‚Äî –≤—Å–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–æ (–±–∞–π—Ç)
  * `sess_uplink` ‚Äî –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ (–±–∞–π—Ç)
  * `sess_downlink` ‚Äî –ø–æ–ª—É—á–µ–Ω–æ –≤ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ (–±–∞–π—Ç)
  * `enabled` ‚Äî –≤–∫–ª—é—á–µ–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
  * `sub_end` ‚Äî –¥–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
  * `renew` ‚Äî —Å—Ç–∞—Ç—É—Å/–¥–∞—Ç–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏—è
  * `lim_ip` ‚Äî –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ IP
  * `ips` ‚Äî —Å–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å–æ–≤
  * `created` ‚Äî –¥–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è

#### –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:

–ï—Å–ª–∏ –ø–æ–ª–µ `columns` –Ω–µ —É–∫–∞–∑–∞–Ω–æ –∏–ª–∏ –ø—É—Å—Ç–æ–µ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è.

–ï—Å–ª–∏ –ø–æ–ª–µ `sort` –Ω–µ –∑–∞–¥–∞–Ω–æ:

* –î–ª—è `server` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `source ASC`
* –î–ª—è `client` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `user ASC`

–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏ –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –±—É–¥—É—Ç –ø—Ä–æ–∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω—ã, –∏ –≤ –ª–æ–≥–∞—Ö –ø–æ—è–≤—è—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.

#### –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –±–µ–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ —Å–µ—Ä–≤–µ—Ä—É:

```yaml
stats_columns:
  server:
    columns: []
  client:
    columns:
      - user
      - rate
      - uplink
      - downlink
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ —á–µ—Ä–µ–∑ URL

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞:

```bash
curl "http://127.0.0.1:9952/api/v1/stats?sort_by=rate&sort_order=DESC"
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ DNS

**GET** `/api/v1/dns_stats`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `user`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –¥–ª—è –∫–æ—Ç–æ—Ä–æ–≥–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ DNS.
  - `count`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π DNS-–∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞.

```bash
curl -X GET "http://127.0.0.1:9952/api/v1/dns_stats?user=newuser&count=10"
```

### –£–¥–∞–ª—è–µ—Ç –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã DNS-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**POST** `/api/v1/delete_dns_stats`

```bash
curl -X POST http://127.0.0.1:9952/api/v1/delete_dns_stats
```

### –°–±—Ä–æ—Å —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ traffic_stats –∫–æ–ª–æ–Ω–æ–∫ `uplink` –∏ `downlink`

**POST** `/api/v1/reset_traffic_stats`

```bash
curl -X POST http://127.0.0.1:9952/api/v1/reset_traffic_stats
```

### –°–±—Ä–æ—Å —Ç—Ä–∞—Ñ–∏–∫–∞ –≤ —Ç–∞–±–ª–∏—Ü–µ clients_stats –∫–æ–ª–æ–Ω–æ–∫ `uplink` –∏ `downlink`

**POST** `/api/v1/reset_clients_stats`

```bash
curl -X POST http://127.0.0.1:9952/api/v1/reset_clients_stats
```

### –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–µ—Ç–µ–≤–æ–≥–æ —Ç—Ä–∞—Ñ–∏–∫–∞

**POST** `/api/v1/reset_traffic`

```bash
curl -X POST http://127.0.0.1:9952/api/v1/reset_traffic
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**POST** `/api/v1/add_user`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `user`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `credential`: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (UUID –¥–ª—è VLESS –∏–ª–∏ PASSWORD –¥–ª—è Trojan).
  - `inboundTag`: –¢–µ–≥ –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `vless-in` –∏–ª–∏ `trojan-in`).

```bash
curl -X POST http://127.0.0.1:9952/api/v1/add_user -d "user=newuser&credential=123e4567-e89b-12d3-a456-426614174000&inboundTag=vless-in"
```

### –ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**POST** `/api/v1/bulk_add_users`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `users_file`: –§–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ `user,credential,inboundTag`.
    - –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:
      - `user,credential,inboundTag`: –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, `user1,550e8400-e29b-41d4-a716-446655440000,vless-in`).
      - `user,credential`: –ë–µ–∑ `inboundTag`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
      - `user`: –¢–æ–ª—å–∫–æ –∏–º—è, `credential` (UUID) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
      - `user,,inboundTag`: –ò–º—è –∏ `inboundTag`, `credential` (UUID) –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

```bash
curl -X POST "http://127.0.0.1:9952/api/v1/bulk_add_users" -F "users_file=@users.txt"
```
 - –ü—Ä–∏–º–µ—Ä —Ñ–∞–π–ª–∞ `users.txt`:
```
user1,550e8400-e29b-41d4-a716-446655440000,vless-in  # –ü–æ–ª–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
user2,6ba7b810-9dad-11d1-80b4-00c04fd430c8           # –ë–µ–∑ inboundTag
user3                                                # –¢–æ–ª—å–∫–æ –∏–º—è, UUID –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
user4,,vless-in                                      # –ò–º—è –∏ inboundTag, UUID –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
```

### –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**DELETE** `/api/v1/delete_user`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `user`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `inboundTag`: –¢–µ–≥ –≤—Ö–æ–¥—è—â–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, `vless-in`).

```bash
curl -X DELETE "http://127.0.0.1:9952/api/v1/delete_user?user=newuser&inboundTag=vless-in"
```

### –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**PATCH** `/api/v1/set_enabled`  
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `user`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `enabled`: –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (`true` ‚Äî –≤–∫–ª—é—á–∏—Ç—å, `false` ‚Äî –æ—Ç–∫–ª—é—á–∏—Ç—å).

```bash
curl -X PATCH http://127.0.0.1:9952/api/v1/set_enabled -d "user=newuser&enabled=false"
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ IP –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**PATCH** `/api/v1/update_lim_ip`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `user`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `lim_ip`: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ IP-–∞–¥—Ä–µ—Å–æ–≤.

```bash
curl -X PATCH http://127.0.0.1:9952/api/v1/update_lim_ip -d "user=newuser&lim_ip=5"
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞—Ç—ã –ø–æ–¥–ø–∏—Å–∫–∏

**PATCH** `/api/v1/adjust_date`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `user`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `sub_end`: –°–º–µ—â–µ–Ω–∏–µ —Å—Ä–æ–∫–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –≤ —Ñ–æ—Ä–º–∞—Ç–µ `+–¥–Ω–∏:—á–∞—Å—ã`, `-–¥–Ω–∏`

```bash
curl -X PATCH http://127.0.0.1:9952/api/v1/adjust_date -d "user=newuser&sub_end=+30:0"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏

**PATCH** `/api/v1/update_renew`
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `user`: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
  - `renew`: –ü–µ—Ä–∏–æ–¥ –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏—è –≤ –¥–Ω—è—Ö.

```bash
curl -X PATCH http://127.0.0.1:9952/api/v1/update_renew -d "user=newuser&renew=30"
```

---


### –í–∫–ª—é—á–µ–Ω–∏–µ API –¥–ª—è —è–¥–µ—Ä

–í–∫–ª—é—á–µ–Ω–∏–µ API –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —è–¥—Ä–∞—Ö **Singbox** –∏ **Xray**.

#### Singbox

```json
"experimental": {
  "v2ray_api": {
    "listen": "127.0.0.1:9953",
    "stats": {
      "enabled": true,
      "inbounds": [
        "trojan-in",
        "vless-in"
      ],
      "outbounds": [
        "warp",
        "direct",
        "IPv4"
      ],
      "users": [
        "user1",
        "user2"
      ]
    }
  }
}
```

#### Xray

```json
"api": {
  "tag": "api",
  "listen": "127.0.0.1:9953",
  "services": [
    "HandlerService",
    "StatsService",
    "ReflectionService"
  ]
},
```